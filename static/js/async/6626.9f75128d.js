"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([["6626"],{2905:function(n,e,s){s.r(e),s.d(e,{default:()=>h});var r=s(1549),i=s(6603);function d(n){let e=Object.assign({h1:"h1",a:"a",p:"p",h3:"h3",h4:"h4",ul:"ul",li:"li",strong:"strong",ol:"ol",h2:"h2",code:"code",pre:"pre"},(0,i.ah)(),n.components);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(e.h1,{id:"模組連結",children:["模組連結",(0,r.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#模組連結",children:"#"})]}),"\n",(0,r.jsx)(e.p,{children:"Gez 框架提供了一套完整的模組連結機制，用於管理服務間的程式碼共享和依賴關係。該機制基於 ESM（ECMAScript Module）規範實現，支援原始碼層級的模組匯出和匯入，以及完整的依賴管理功能。"}),"\n",(0,r.jsxs)(e.h3,{id:"核心概念",children:["核心概念",(0,r.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#核心概念",children:"#"})]}),"\n",(0,r.jsxs)(e.h4,{id:"模組匯出",children:["模組匯出",(0,r.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#模組匯出",children:"#"})]}),"\n",(0,r.jsx)(e.p,{children:"模組匯出是將服務中的特定程式碼單元（如元件、工具函數等）以 ESM 格式對外暴露的過程。支援兩種匯出類型："}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"原始碼匯出"}),"：直接匯出專案中的原始碼檔案"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"依賴匯出"}),"：匯出專案使用的第三方依賴套件"]}),"\n"]}),"\n",(0,r.jsxs)(e.h4,{id:"模組匯入",children:["模組匯入",(0,r.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#模組匯入",children:"#"})]}),"\n",(0,r.jsx)(e.p,{children:"模組匯入是在服務中引用其他服務匯出的程式碼單元的過程。支援多種安裝方式："}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"原始碼安裝"}),"：適用於開發環境，支援即時修改和熱更新"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"軟體包安裝"}),"：適用於生產環境，直接使用建置產物"]}),"\n"]}),"\n",(0,r.jsxs)(e.h3,{id:"預載機制",children:["預載機制",(0,r.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#預載機制",children:"#"})]}),"\n",(0,r.jsx)(e.p,{children:"為了優化服務效能，Gez 實現了智能的模組預載機制："}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"依賴分析"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"建置時分析元件間的依賴關係"}),"\n",(0,r.jsx)(e.li,{children:"識別關鍵路徑上的核心模組"}),"\n",(0,r.jsx)(e.li,{children:"確定模組的載入優先級"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"載入策略"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"立即載入"}),"：關鍵路徑上的核心模組"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"延遲載入"}),"：非關鍵功能模組"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"按需載入"}),"：條件渲染的模組"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"資源優化"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"智能的程式碼分割策略"}),"\n",(0,r.jsx)(e.li,{children:"模組層級的快取管理"}),"\n",(0,r.jsx)(e.li,{children:"按需編譯和打包"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.h2,{id:"模組匯出-1",children:["模組匯出",(0,r.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#模組匯出-1",children:"#"})]}),"\n",(0,r.jsxs)(e.h3,{id:"配置說明",children:["配置說明",(0,r.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#配置說明",children:"#"})]}),"\n",(0,r.jsxs)(e.p,{children:["在 ",(0,r.jsx)(e.code,{children:"entry.node.ts"})," 中配置需要匯出的模組："]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",meta:'title="src/entry.node.ts"',children:"import type { GezOptions } from '@gez/core';\n\nexport default {\n    modules: {\n        exports: [\n            // 匯出原始碼檔案\n            'root:src/components/button.vue',  // Vue 元件\n            'root:src/utils/format.ts',        // 工具函數\n            // 匯出第三方依賴\n            'npm:vue',                         // Vue 框架\n            'npm:vue-router'                   // Vue Router\n        ]\n    }\n} satisfies GezOptions;\n"})}),"\n",(0,r.jsx)(e.p,{children:"匯出配置支援兩種類型："}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"root:*"}),"：匯出原始碼檔案，路徑相對於專案根目錄"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"npm:*"}),"：匯出第三方依賴，直接指定套件名稱"]}),"\n"]}),"\n",(0,r.jsxs)(e.h2,{id:"模組匯入-1",children:["模組匯入",(0,r.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#模組匯入-1",children:"#"})]}),"\n",(0,r.jsxs)(e.h3,{id:"配置說明-1",children:["配置說明",(0,r.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#配置說明-1",children:"#"})]}),"\n",(0,r.jsxs)(e.p,{children:["在 ",(0,r.jsx)(e.code,{children:"entry.node.ts"})," 中配置需要匯入的模組："]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",meta:'title="src/entry.node.ts"',children:"import type { GezOptions } from '@gez/core';\n\nexport default {\n    modules: {\n        // 匯入配置\n        imports: {\n            // 原始碼安裝：指向建置產物目錄\n            'ssr-remote': 'root:./node_modules/ssr-remote/dist',\n            // 軟體包安裝：指向套件目錄\n            'other-remote': 'root:./node_modules/other-remote'\n        },\n        // 外部依賴配置\n        externals: {\n            // 使用遠端模組中的依賴\n            'vue': 'ssr-remote/npm/vue',\n            'vue-router': 'ssr-remote/npm/vue-router'\n        }\n    }\n} satisfies GezOptions;\n"})}),"\n",(0,r.jsx)(e.p,{children:"配置項說明："}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"imports"}),"：配置遠端模組的本地路徑"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"原始碼安裝：指向建置產物目錄（dist）"}),"\n",(0,r.jsx)(e.li,{children:"軟體包安裝：直接指向套件目錄"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"externals"}),"：配置外部依賴"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"用於共享遠端模組中的依賴"}),"\n",(0,r.jsx)(e.li,{children:"避免重複打包相同依賴"}),"\n",(0,r.jsx)(e.li,{children:"支援多個模組共享依賴"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.h3,{id:"安裝方式",children:["安裝方式",(0,r.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#安裝方式",children:"#"})]}),"\n",(0,r.jsxs)(e.h4,{id:"原始碼安裝",children:["原始碼安裝",(0,r.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#原始碼安裝",children:"#"})]}),"\n",(0,r.jsx)(e.p,{children:"適用於開發環境，支援即時修改和熱更新。"}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Workspace 方式"}),"\n推薦在 Monorepo 專案中使用："]}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",meta:'title="package.json"',children:'{\n    "devDependencies": {\n        "ssr-remote": "workspace:*"\n    }\n}\n'})}),"\n",(0,r.jsxs)(e.ol,{start:"2",children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Link 方式"}),"\n用於本地開發除錯："]}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",meta:'title="package.json"',children:'{\n    "devDependencies": {\n        "ssr-remote": "link:../ssr-remote"\n    }\n}\n'})}),"\n",(0,r.jsxs)(e.h4,{id:"軟體包安裝",children:["軟體包安裝",(0,r.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#軟體包安裝",children:"#"})]}),"\n",(0,r.jsx)(e.p,{children:"適用於生產環境，直接使用建置產物。"}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"NPM Registry"}),"\n透過 npm registry 安裝："]}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",meta:'title="package.json"',children:'{\n    "dependencies": {\n        "ssr-remote": "^1.0.0"\n    }\n}\n'})}),"\n",(0,r.jsxs)(e.ol,{start:"2",children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"靜態伺服器"}),"\n透過 HTTP/HTTPS 協定安裝："]}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",meta:'title="package.json"',children:'{\n    "dependencies": {\n        "ssr-remote": "https://cdn.example.com/ssr-remote/1.0.0.tgz"\n    }\n}\n'})}),"\n",(0,r.jsxs)(e.h2,{id:"軟體包建置",children:["軟體包建置",(0,r.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#軟體包建置",children:"#"})]}),"\n",(0,r.jsxs)(e.h3,{id:"配置說明-2",children:["配置說明",(0,r.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#配置說明-2",children:"#"})]}),"\n",(0,r.jsxs)(e.p,{children:["在 ",(0,r.jsx)(e.code,{children:"entry.node.ts"})," 中配置建置選項："]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",meta:'title="src/entry.node.ts"',children:"import type { GezOptions } from '@gez/core';\n\nexport default {\n    // 模組匯出配置\n    modules: {\n        exports: [\n            'root:src/components/button.vue',\n            'root:src/utils/format.ts',\n            'npm:vue'\n        ]\n    },\n    // 建置配置\n    pack: {\n        // 啟用建置\n        enable: true,\n\n        // 輸出配置\n        outputs: [\n            'dist/client/versions/latest.tgz',\n            'dist/client/versions/1.0.0.tgz'\n        ],\n\n        // 自訂 package.json\n        packageJson: async (gez, pkg) => {\n            pkg.version = '1.0.0';\n            return pkg;\n        },\n\n        // 建置前處理\n        onBefore: async (gez, pkg) => {\n            // 產生類型宣告\n            // 執行測試用例\n            // 更新文件等\n        },\n\n        // 建置後處理\n        onAfter: async (gez, pkg, file) => {\n            // 上傳到 CDN\n            // 發布到 npm 倉庫\n            // 部署到測試環境等\n        }\n    }\n} satisfies GezOptions;\n"})}),"\n",(0,r.jsxs)(e.h3,{id:"建置產物",children:["建置產物",(0,r.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#建置產物",children:"#"})]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"your-app-name.tgz\n├── package.json        # 套件資訊\n├── index.js            # 生產環境入口\n├── server/             # 伺服器端資源\n│   └── manifest.json   # 伺服器端資源映射\n├── node/               # Node.js 執行環境\n└── client/             # 客戶端資源\n    └── manifest.json   # 客戶端資源映射\n"})}),"\n",(0,r.jsxs)(e.h3,{id:"發布流程",children:["發布流程",(0,r.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#發布流程",children:"#"})]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# 1. 建置生產版本\ngez build\n\n# 2. 發布到 npm\nnpm publish dist/versions/your-app-name.tgz\n"})}),"\n",(0,r.jsxs)(e.h2,{id:"最佳實踐",children:["最佳實踐",(0,r.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#最佳實踐",children:"#"})]}),"\n",(0,r.jsxs)(e.h3,{id:"開發環境配置",children:["開發環境配置",(0,r.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#開發環境配置",children:"#"})]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"依賴管理"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"使用 Workspace 或 Link 方式安裝依賴"}),"\n",(0,r.jsx)(e.li,{children:"統一管理依賴版本"}),"\n",(0,r.jsx)(e.li,{children:"避免重複安裝相同依賴"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"開發體驗"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"啟用熱更新功能"}),"\n",(0,r.jsx)(e.li,{children:"配置合適的預載策略"}),"\n",(0,r.jsx)(e.li,{children:"優化建置速度"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.h3,{id:"生產環境配置",children:["生產環境配置",(0,r.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#生產環境配置",children:"#"})]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"部署策略"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"使用 NPM Registry 或靜態伺服器"}),"\n",(0,r.jsx)(e.li,{children:"確保建置產物完整性"}),"\n",(0,r.jsx)(e.li,{children:"實施灰度發布機制"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"效能優化"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"合理配置資源預載"}),"\n",(0,r.jsx)(e.li,{children:"優化模組載入順序"}),"\n",(0,r.jsx)(e.li,{children:"實施有效的快取策略"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.h3,{id:"版本管理",children:["版本管理",(0,r.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#版本管理",children:"#"})]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"版本規範"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"遵循語意化版本規範"}),"\n",(0,r.jsx)(e.li,{children:"維護詳細的更新日誌"}),"\n",(0,r.jsx)(e.li,{children:"做好版本相容性測試"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"依賴更新"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"及時更新依賴套件"}),"\n",(0,r.jsx)(e.li,{children:"定期進行安全審計"}),"\n",(0,r.jsx)(e.li,{children:"保持依賴版本一致性"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\n"})})]})}function l(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:e}=Object.assign({},(0,i.ah)(),n.components);return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(d,{...n})}):d(n)}let h=l;l.__RSPRESS_PAGE_META={},l.__RSPRESS_PAGE_META["zh-TW%2Fguide%2Fessentials%2Fmodule-link.md"]={toc:[{text:"核心概念",id:"核心概念",depth:3},{text:"模組匯出",id:"模組匯出",depth:4},{text:"模組匯入",id:"模組匯入",depth:4},{text:"預載機制",id:"預載機制",depth:3},{text:"模組匯出",id:"模組匯出-1",depth:2},{text:"配置說明",id:"配置說明",depth:3},{text:"模組匯入",id:"模組匯入-1",depth:2},{text:"配置說明",id:"配置說明-1",depth:3},{text:"安裝方式",id:"安裝方式",depth:3},{text:"原始碼安裝",id:"原始碼安裝",depth:4},{text:"軟體包安裝",id:"軟體包安裝",depth:4},{text:"軟體包建置",id:"軟體包建置",depth:2},{text:"配置說明",id:"配置說明-2",depth:3},{text:"建置產物",id:"建置產物",depth:3},{text:"發布流程",id:"發布流程",depth:3},{text:"最佳實踐",id:"最佳實踐",depth:2},{text:"開發環境配置",id:"開發環境配置",depth:3},{text:"生產環境配置",id:"生產環境配置",depth:3},{text:"版本管理",id:"版本管理",depth:3}],title:"模組連結",headingTitle:"模組連結",frontmatter:{titleSuffix:"Gez 框架服務間程式碼共享機制",description:"詳細介紹 Gez 框架的模組連結機制，包括服務間程式碼共享、依賴管理和 ESM 規範實現，幫助開發者構建高效的微前端應用。",head:[["meta",{property:"keywords",content:"Gez, 模組連結, Module Link, ESM, 程式碼共享, 依賴管理, 微前端"}]]}}}}]);