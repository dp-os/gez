"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([["1198"],{2218:function(n,e,t){t.r(e),t.d(e,{default:()=>s});var r=t(1549),h=t(6603);function c(n){let e=Object.assign({h1:"h1",a:"a",p:"p",h2:"h2",pre:"pre",code:"code",h3:"h3",ol:"ol",li:"li"},(0,h.ah)(),n.components);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(e.h1,{id:"html",children:["HTML",(0,r.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#html",children:"#"})]}),"\n",(0,r.jsx)(e.p,{children:"Hướng dẫn n\xe0y sẽ gi\xfap bạn x\xe2y dựng một ứng dụng HTML SSR từ đầu dựa tr\xean Gez. Ch\xfang ta sẽ sử dụng một v\xed dụ ho\xe0n chỉnh để minh họa c\xe1ch tạo ứng dụng render ph\xeda m\xe1y chủ bằng Gez framework."}),"\n",(0,r.jsxs)(e.h2,{id:"cấu-tr\\xfac-dự-\\xe1n",children:["Cấu tr\xfac dự \xe1n",(0,r.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#cấu-tr\\xfac-dự-\\xe1n",children:"#"})]}),"\n",(0,r.jsx)(e.p,{children:"Đầu ti\xean, h\xe3y t\xecm hiểu cấu tr\xfac cơ bản của dự \xe1n:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:".\n├── package.json         # Tệp cấu h\xecnh dự \xe1n, định nghĩa c\xe1c phụ thuộc v\xe0 lệnh script\n├── tsconfig.json        # Tệp cấu h\xecnh TypeScript, thiết lập c\xe1c t\xf9y chọn bi\xean dịch\n└── src                  # Thư mục m\xe3 nguồn\n    ├── app.ts           # Th\xe0nh phần ch\xednh của ứng dụng, định nghĩa cấu tr\xfac trang v\xe0 logic tương t\xe1c\n    ├── create-app.ts    # Nh\xe0 m\xe1y tạo thể hiện ứng dụng, chịu tr\xe1ch nhiệm khởi tạo ứng dụng\n    ├── entry.client.ts  # Tệp đầu v\xe0o ph\xeda m\xe1y kh\xe1ch, xử l\xfd render ph\xeda tr\xecnh duyệt\n    ├── entry.node.ts    # Tệp đầu v\xe0o Node.js server, chịu tr\xe1ch nhiệm cấu h\xecnh m\xf4i trường ph\xe1t triển v\xe0 khởi động server\n    └── entry.server.ts  # Tệp đầu v\xe0o ph\xeda m\xe1y chủ, xử l\xfd logic render SSR\n"})}),"\n",(0,r.jsxs)(e.h2,{id:"cấu-h\\xecnh-dự-\\xe1n",children:["Cấu h\xecnh dự \xe1n",(0,r.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#cấu-h\\xecnh-dự-\\xe1n",children:"#"})]}),"\n",(0,r.jsxs)(e.h3,{id:"packagejson",children:["package.json",(0,r.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#packagejson",children:"#"})]}),"\n",(0,r.jsxs)(e.p,{children:["Tạo tệp ",(0,r.jsx)(e.code,{children:"package.json"}),", cấu h\xecnh c\xe1c phụ thuộc v\xe0 script của dự \xe1n:"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-json",meta:'title="package.json"',children:'{\n  "name": "ssr-demo-html",\n  "version": "1.0.0",\n  "type": "module",\n  "private": true,\n  "scripts": {\n    "dev": "gez dev",\n    "build": "npm run build:dts && npm run build:ssr",\n    "build:ssr": "gez build",\n    "preview": "gez preview",\n    "start": "NODE_ENV=production node dist/index.js",\n    "build:dts": "tsc --declaration --emitDeclarationOnly --outDir dist/src"\n  },\n  "dependencies": {\n    "@gez/core": "*"\n  },\n  "devDependencies": {\n    "@gez/rspack": "*",\n    "@types/node": "22.8.6",\n    "typescript": "^5.7.3"\n  }\n}\n'})}),"\n",(0,r.jsxs)(e.p,{children:["Sau khi tạo tệp ",(0,r.jsx)(e.code,{children:"package.json"}),", bạn cần c\xe0i đặt c\xe1c phụ thuộc của dự \xe1n. Bạn c\xf3 thể sử dụng một trong c\xe1c lệnh sau để c\xe0i đặt:"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"pnpm install\n# hoặc\nyarn install\n# hoặc\nnpm install\n"})}),"\n",(0,r.jsx)(e.p,{children:"Lệnh n\xe0y sẽ c\xe0i đặt tất cả c\xe1c g\xf3i phụ thuộc cần thiết, bao gồm TypeScript v\xe0 c\xe1c phụ thuộc li\xean quan đến SSR."}),"\n",(0,r.jsxs)(e.h3,{id:"tsconfigjson",children:["tsconfig.json",(0,r.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#tsconfigjson",children:"#"})]}),"\n",(0,r.jsxs)(e.p,{children:["Tạo tệp ",(0,r.jsx)(e.code,{children:"tsconfig.json"}),", cấu h\xecnh c\xe1c t\xf9y chọn bi\xean dịch TypeScript:"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-json",meta:'title="tsconfig.json"',children:'{\n    "compilerOptions": {\n        "module": "ESNext",\n        "moduleResolution": "node",\n        "isolatedModules": true,\n        "resolveJsonModule": true,\n        \n        "target": "ESNext",\n        "lib": ["ESNext", "DOM"],\n        \n        "strict": true,\n        "skipLibCheck": true,\n        "types": ["@types/node"],\n        \n        "experimentalDecorators": true,\n        "allowSyntheticDefaultImports": true,\n        \n        "baseUrl": ".",\n        "paths": {\n            "ssr-demo-html/src/*": ["./src/*"],\n            "ssr-demo-html/*": ["./*"]\n        }\n    },\n    "include": ["src"],\n    "exclude": ["dist", "node_modules"]\n}\n'})}),"\n",(0,r.jsxs)(e.h2,{id:"cấu-tr\\xfac-m\\xe3-nguồn",children:["Cấu tr\xfac m\xe3 nguồn",(0,r.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#cấu-tr\\xfac-m\\xe3-nguồn",children:"#"})]}),"\n",(0,r.jsxs)(e.h3,{id:"appts",children:["app.ts",(0,r.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#appts",children:"#"})]}),"\n",(0,r.jsxs)(e.p,{children:["Tạo th\xe0nh phần ch\xednh của ứng dụng ",(0,r.jsx)(e.code,{children:"src/app.ts"}),", triển khai cấu tr\xfac trang v\xe0 logic tương t\xe1c:"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",meta:'title="src/app.ts"',children:"/**\n * @file V\xed dụ th\xe0nh phần\n * @description Hiển thị ti\xeau đề trang với thời gian cập nhật tự động, d\xf9ng để minh họa c\xe1c chức năng cơ bản của Gez framework\n */\n\nexport default class App {\n    /**\n     * Thời gian hiện tại, sử dụng định dạng ISO\n     * @type {string}\n     */\n    public time = '';\n\n    /**\n     * Tạo thể hiện ứng dụng\n     * @param {SsrContext} [ssrContext] - Ngữ cảnh ph\xeda m\xe1y chủ, chứa tập hợp si\xeau dữ liệu nhập\n     */\n    public constructor(public ssrContext?: SsrContext) {\n        // Kh\xf4ng cần khởi tạo th\xeam trong constructor\n    }\n\n    /**\n     * Render nội dung trang\n     * @returns {string} Trả về cấu tr\xfac HTML của trang\n     */\n    public render(): string {\n        // Đảm bảo thu thập si\xeau dữ liệu nhập ch\xednh x\xe1c trong m\xf4i trường m\xe1y chủ\n        if (this.ssrContext) {\n            this.ssrContext.importMetaSet.add(import.meta);\n        }\n\n        return `\n        <div id=\"app\">\n            <h1><a href=\"https://www.jsesm.com/guide/frameworks/html.html\" target=\"_blank\">Bắt đầu nhanh với Gez</a></h1>\n            <time datetime=\"${this.time}\">${this.time}</time>\n        </div>\n        `;\n    }\n\n    /**\n     * Khởi tạo ph\xeda m\xe1y kh\xe1ch\n     * @throws {Error} N\xe9m lỗi khi kh\xf4ng t\xecm thấy phần tử hiển thị thời gian\n     */\n    public onClient(): void {\n        // Lấy phần tử hiển thị thời gian\n        const time = document.querySelector('#app time');\n        if (!time) {\n            throw new Error('Kh\xf4ng t\xecm thấy phần tử hiển thị thời gian');\n        }\n\n        // Thiết lập bộ đếm thời gian, cập nhật thời gian mỗi gi\xe2y\n        setInterval(() => {\n            this.time = new Date().toISOString();\n            time.setAttribute('datetime', this.time);\n            time.textContent = this.time;\n        }, 1000);\n    }\n\n    /**\n     * Khởi tạo ph\xeda m\xe1y chủ\n     */\n    public onServer(): void {\n        this.time = new Date().toISOString();\n    }\n}\n\n/**\n * Giao diện ngữ cảnh ph\xeda m\xe1y chủ\n * @interface\n */\nexport interface SsrContext {\n    /**\n     * Tập hợp si\xeau dữ liệu nhập\n     * @type {Set<ImportMeta>}\n     */\n    importMetaSet: Set<ImportMeta>;\n}\n"})}),"\n",(0,r.jsxs)(e.h3,{id:"create-appts",children:["create-app.ts",(0,r.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#create-appts",children:"#"})]}),"\n",(0,r.jsxs)(e.p,{children:["Tạo tệp ",(0,r.jsx)(e.code,{children:"src/create-app.ts"}),", chịu tr\xe1ch nhiệm tạo thể hiện ứng dụng:"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",meta:'title="src/create-app.ts"',children:"/**\n * @file Tạo thể hiện ứng dụng\n * @description Chịu tr\xe1ch nhiệm tạo v\xe0 cấu h\xecnh thể hiện ứng dụng\n */\n\nimport App from './app';\n\nexport function createApp() {\n    const app = new App();\n    return {\n        app\n    };\n}\n"})}),"\n",(0,r.jsxs)(e.h3,{id:"entryclientts",children:["entry.client.ts",(0,r.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#entryclientts",children:"#"})]}),"\n",(0,r.jsxs)(e.p,{children:["Tạo tệp đầu v\xe0o ph\xeda m\xe1y kh\xe1ch ",(0,r.jsx)(e.code,{children:"src/entry.client.ts"}),":"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",meta:'title="src/entry.client.ts"',children:"/**\n * @file Tệp đầu v\xe0o ph\xeda m\xe1y kh\xe1ch\n * @description Chịu tr\xe1ch nhiệm logic tương t\xe1c ph\xeda m\xe1y kh\xe1ch v\xe0 cập nhật động\n */\n\nimport { createApp } from './create-app';\n\n// Tạo thể hiện ứng dụng v\xe0 khởi tạo\nconst { app } = createApp();\napp.onClient();\n"})}),"\n",(0,r.jsxs)(e.h3,{id:"entrynodets",children:["entry.node.ts",(0,r.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#entrynodets",children:"#"})]}),"\n",(0,r.jsxs)(e.p,{children:["Tạo tệp ",(0,r.jsx)(e.code,{children:"entry.node.ts"}),", cấu h\xecnh m\xf4i trường ph\xe1t triển v\xe0 khởi động server:"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",meta:'title="src/entry.node.ts"',children:"/**\n * @file Tệp đầu v\xe0o Node.js server\n * @description Chịu tr\xe1ch nhiệm cấu h\xecnh m\xf4i trường ph\xe1t triển v\xe0 khởi động server, cung cấp m\xf4i trường thực thi SSR\n */\n\nimport http from 'node:http';\nimport type { GezOptions } from '@gez/core';\n\nexport default {\n    /**\n     * Cấu h\xecnh tr\xecnh tạo ứng dụng cho m\xf4i trường ph\xe1t triển\n     * @description Tạo v\xe0 cấu h\xecnh thể hiện ứng dụng Rspack, d\xf9ng để x\xe2y dựng v\xe0 cập nhật n\xf3ng trong m\xf4i trường ph\xe1t triển\n     * @param gez Thể hiện Gez framework, cung cấp c\xe1c chức năng v\xe0 giao diện cấu h\xecnh cốt l\xf5i\n     * @returns Trả về thể hiện ứng dụng Rspack đ\xe3 được cấu h\xecnh, hỗ trợ HMR v\xe0 xem trước thời gian thực\n     */\n    async devApp(gez) {\n        return import('@gez/rspack').then((m) =>\n            m.createRspackHtmlApp(gez, {\n                config(context) {\n                    // T\xf9y chỉnh cấu h\xecnh bi\xean dịch Rspack tại đ\xe2y\n                }\n            })\n        );\n    },\n\n    /**\n     * Cấu h\xecnh v\xe0 khởi động HTTP server\n     * @description Tạo thể hiện HTTP server, t\xedch hợp middleware Gez, xử l\xfd y\xeau cầu SSR\n     * @param gez Thể hiện Gez framework, cung cấp middleware v\xe0 chức năng render\n     */\n    async server(gez) {\n        const server = http.createServer((req, res) => {\n            // Sử dụng middleware Gez để xử l\xfd y\xeau cầu\n            gez.middleware(req, res, async () => {\n                // Thực hiện render ph\xeda m\xe1y chủ\n                const rc = await gez.render({\n                    params: { url: req.url }\n                });\n                res.end(rc.html);\n            });\n        });\n\n        server.listen(3000, () => {\n            console.log('Dịch vụ đ\xe3 khởi động: http://localhost:3000');\n        });\n    }\n} satisfies GezOptions;\n"})}),"\n",(0,r.jsx)(e.p,{children:"Tệp n\xe0y l\xe0 tệp đầu v\xe0o cấu h\xecnh m\xf4i trường ph\xe1t triển v\xe0 khởi động server, chứa hai chức năng ch\xednh:"}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:["H\xe0m ",(0,r.jsx)(e.code,{children:"devApp"}),": Chịu tr\xe1ch nhiệm tạo v\xe0 cấu h\xecnh thể hiện ứng dụng Rspack cho m\xf4i trường ph\xe1t triển, hỗ trợ cập nhật n\xf3ng v\xe0 xem trước thời gian thực."]}),"\n",(0,r.jsxs)(e.li,{children:["H\xe0m ",(0,r.jsx)(e.code,{children:"server"}),": Chịu tr\xe1ch nhiệm tạo v\xe0 cấu h\xecnh HTTP server, t\xedch hợp middleware Gez để xử l\xfd y\xeau cầu SSR."]}),"\n"]}),"\n",(0,r.jsxs)(e.h3,{id:"entryserverts",children:["entry.server.ts",(0,r.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#entryserverts",children:"#"})]}),"\n",(0,r.jsxs)(e.p,{children:["Tạo tệp đầu v\xe0o render ph\xeda m\xe1y chủ ",(0,r.jsx)(e.code,{children:"src/entry.server.ts"}),":"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",meta:'title="src/entry.server.ts"',children:"/**\n * @file Tệp đầu v\xe0o render ph\xeda m\xe1y chủ\n * @description Chịu tr\xe1ch nhiệm quy tr\xecnh render ph\xeda m\xe1y chủ, tạo HTML v\xe0 ch\xe8n t\xe0i nguy\xean\n */\n\nimport type { RenderContext } from '@gez/core';\nimport type App from './app';\nimport type { SsrContext } from './app';\nimport { createApp } from './create-app';\n\n// Đ\xf3ng g\xf3i logic tạo nội dung trang\nconst renderToString = (app: App, ssrContext: SsrContext): string => {\n    // Ch\xe8n ngữ cảnh render ph\xeda m\xe1y chủ v\xe0o thể hiện ứng dụng\n    app.ssrContext = ssrContext;\n    // Khởi tạo ph\xeda m\xe1y chủ\n    app.onServer();\n\n    // Tạo nội dung trang\n    return app.render();\n};\n\nexport default async (rc: RenderContext) => {\n    // Tạo thể hiện ứng dụng, trả về đối tượng chứa thể hiện app\n    const { app } = createApp();\n    // Sử dụng renderToString để tạo nội dung trang\n    const html = renderToString(app, {\n        importMetaSet: rc.importMetaSet\n    });\n\n    // Cam kết thu thập phụ thuộc, đảm bảo tất cả t\xe0i nguy\xean cần thiết được tải\n    await rc.commit();\n\n    // Tạo cấu tr\xfac HTML ho\xe0n chỉnh\n    rc.html = `<!DOCTYPE html>\n<html lang=\"vi\">\n<head>\n    ${rc.preload()}\n    <title>Bắt đầu nhanh với Gez</title>\n    ${rc.css()}\n</head>\n<body>\n    ${html}\n    ${rc.importmap()}\n    ${rc.moduleEntry()}\n    ${rc.modulePreload()}\n</body>\n</html>\n`;\n};\n"})}),"\n",(0,r.jsxs)(e.h2,{id:"chạy-dự-\\xe1n",children:["Chạy dự \xe1n",(0,r.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#chạy-dự-\\xe1n",children:"#"})]}),"\n",(0,r.jsx)(e.p,{children:"Sau khi ho\xe0n th\xe0nh cấu h\xecnh c\xe1c tệp tr\xean, bạn c\xf3 thể sử dụng c\xe1c lệnh sau để chạy dự \xe1n:"}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsx)(e.li,{children:"Chế độ ph\xe1t triển:"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"npm run dev\n"})}),"\n",(0,r.jsxs)(e.ol,{start:"2",children:["\n",(0,r.jsx)(e.li,{children:"X\xe2y dựng dự \xe1n:"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"npm run build\n"})}),"\n",(0,r.jsxs)(e.ol,{start:"3",children:["\n",(0,r.jsx)(e.li,{children:"Chạy trong m\xf4i trường sản xuất:"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"npm run start\n"})}),"\n",(0,r.jsxs)(e.p,{children:["B\xe2y giờ, bạn đ\xe3 tạo th\xe0nh c\xf4ng một ứng dụng HTML SSR dựa tr\xean Gez! Truy cập ",(0,r.jsx)(e.a,{href:"http://localhost:3000",target:"_blank",rel:"noopener noreferrer",children:"http://localhost:3000"})," để xem kết quả."]})]})}function i(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:e}=Object.assign({},(0,h.ah)(),n.components);return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(c,{...n})}):c(n)}let s=i;i.__RSPRESS_PAGE_META={},i.__RSPRESS_PAGE_META["vi%2Fguide%2Fframeworks%2Fhtml.md"]={toc:[{text:"Cấu tr\xfac dự \xe1n",id:"cấu-tr\xfac-dự-\xe1n",depth:2},{text:"Cấu h\xecnh dự \xe1n",id:"cấu-h\xecnh-dự-\xe1n",depth:2},{text:"package.json",id:"packagejson",depth:3},{text:"tsconfig.json",id:"tsconfigjson",depth:3},{text:"Cấu tr\xfac m\xe3 nguồn",id:"cấu-tr\xfac-m\xe3-nguồn",depth:2},{text:"app.ts",id:"appts",depth:3},{text:"create-app.ts",id:"create-appts",depth:3},{text:"entry.client.ts",id:"entryclientts",depth:3},{text:"entry.node.ts",id:"entrynodets",depth:3},{text:"entry.server.ts",id:"entryserverts",depth:3},{text:"Chạy dự \xe1n",id:"chạy-dự-\xe1n",depth:2}],title:"HTML",headingTitle:"HTML",frontmatter:{titleSuffix:"V\xed dụ ứng dụng HTML SSR với Gez Framework",description:"Hướng dẫn x\xe2y dựng ứng dụng HTML SSR từ đầu dựa tr\xean Gez, th\xf4ng qua v\xed dụ minh họa c\xe1ch sử dụng cơ bản của framework, bao gồm khởi tạo dự \xe1n, cấu h\xecnh HTML v\xe0 thiết lập tệp đầu v\xe0o.",head:[["meta",{property:"keywords",content:"Gez, HTML, Ứng dụng SSR, Cấu h\xecnh TypeScript, Khởi tạo dự \xe1n, Render ph\xeda m\xe1y chủ, Tương t\xe1c ph\xeda m\xe1y kh\xe1ch"}]]}}}}]);